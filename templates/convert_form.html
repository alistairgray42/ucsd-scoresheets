<html lang="en">

<head>
    <meta charset="utf-8">
    <title>UCSD Scoresheets | Convert</title>
    <link rel="stylesheet" type="text/css" href="/static/style.css">

    <script src="../static/error-success.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script>
	$(document).ready(() => {
	setError = function (message) {
	    if (message) {
		$("#error").html(message);
		$("#error").show();
	    }
	    else {
		$("#error").hide();
	    }
	}

	setSuccess = function (message) {
	    if (message) {
		$("#success").html(message);
		$("#success").show();
	    }
	    else {
		$("#success").hide();
	    }
	}

	    $("#convert-form").submit((e) => {
                e.preventDefault();

                $.getJSON("/convert/submit", $("#convert-form").serialize(), (data) => {
                    if (data.error) {
                        setSuccess("");
                        setError("Error: " + data.error);
                    }
                    else if (data.success) {
                        setError("");
			setSuccess("Conversion request successful. Your SQBS file will be ready (in a second!) at <a href=\"https://ucsd-scoresheets.com/sqbs/" + data.success + "\"> this link </a>.");
                        $("convert-form")[0].reset();
                    }
                });

            })

        });
    </script>
</head>

<body>

    {% include "header.html" %}
    <div id="wrapper">

        <h1>
            Convert to SQBS
        </h1>
        <p>
            This form allows you to convert UCSD scoresheets <b>generated by this site</b> into the standard SQBS file
            format.
        </p>


        <p>
            Note: This feature is experimental and should not be relied on. Use it at your own risk. <b>If you
                choose to use this feature, always have a person familiar with using SQBS on hand as a backup</b>, and
            be prepared to enter stats by hand (luckily, this is easy from the aggregate scoresheet!) I
            don't guarantee that I'll respond to requests for help using this feature.
        </p>

        <p>
            Limitations:
        <ul>
	    <li>This feature only supports standard game lengths and point values: i.e. twenty (or twenty-two or 
	        twenty-four) tossups scored 15/10/-5, and corresponding bonuses with three parts worth ten points each.</li>
            <li>Player names cannot be changed once the tournament starts, unless you manually change players' names in
                each of the room spreadsheets where they played.</li>
            <li>If room spreadsheets are incorrectly filled out, conversion may be incorrect; if it is incorrect, you
                might or might not be notified of that. Once again, always have a person who can use SQBS on hand, and
                make sure to check SQBS files and web reports before posting publicly.</li>
            <li>By design, this page will only send SQBS stats to the accounts that created scoresheets, and will
                only convert the last-created set of scoresheets.</li>
        </ul>
        </p>

        <div id="error"></div>
        <div id="success"></div>

        <form id="convert-form">
            <div class="form-grid">
                <label class="input-prompt" for="email">Email:</label>
                <input type="email" id="email" name="email" placeholder="Email" required>

                <label class="input-prompt">Rounds to Convert:</label>

                <div id="rounds_min_max">
                    <input type="number" id="rounds_min" name="rounds_min" placeholder="Start" min="1" max="16"
                        required>
                    <input type="number" id="rounds_max" name="rounds_max" placeholder="End" min="1" max="16" required>
                </div>
            </div>

            <div class="centering-div">
                <input type="submit" id="submit" value="Submit">
            </div>

        </form>
    </div>

</body>

</html>
